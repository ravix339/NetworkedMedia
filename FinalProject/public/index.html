<html>

<head>
  <title>Memedown</title>
  <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('#upload').on('click', function (evt) {
        $('#status').html('Processing');
        $('#out').attr('src', '');
        var postdata = new FormData();
        postdata.append('img', $('#img')[0].files[0]);
        postdata.append('code', $('#code').val());
        $.ajax({
          type: 'post',
          url: '/process',
          data: postdata,
          processData: false,
          contentType: false,
          success: function (response) {
            $('#status').html('');
            $('#out').attr('src', response.data);
          },
          error: function (error) {
            $('#status').html("Error: " + error.responseJSON.err);
            $('#out').attr('src', '');
          }
        });
      });
    });
  </script>
</head>

<body>
  <input type="file" id="img"> <br />
  <textarea id="code"></textarea><br />
  <input type="submit" value="Submit!" id="upload">
  <img id="out">
  <p id="status"></p>
</body>

</html>